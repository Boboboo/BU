//for testnodes table
CREATE TABLE original_nodes(
   taxid              varchar(255)  PRIMARY KEY     NOT NULL,
   parent_taxid        varchar(255) ,                 
   rank         varchar(255) , 
   embl_code    varchar(255),
   division_id  varchar(255),
   inherited_div_flag             varchar(255),
   genetic_code_id	varchar(255),
   inherited_GC_flag       varchar(255),
   mitochondrial_genetic_code_id      varchar(255),
   inherited_MGC_flag     varchar(255),
   GenBank_hidden_flag        varchar(255),
   hidden_ubtree_root   varchar(255),
   comments     varchar(255),
   extra varchar(255)
);

//for mac
\copy original_nodes from '/Users/air/Desktop/nodes.dmp' (DELIMITER('|'));

//for windows
\copy original_nodes from ‘C:/Users/zhangbo/Desktop/work/data2/nodes.dmp' DELIMITERS ‘|';

create table nodes1 as 
select taxid,parent_taxid,rank from original_nodes;

create index nodes_pkey on nodes1 (taxid);



//for names table
CREATE TABLE original_names(
   taxid              varchar(255) , 
   name        varchar(255) ,                 
   unique_name         varchar(255) , 
   type    varchar(255),
   extra varchar(255)
);

\copy original_names from '/Users/air/Desktop/names.dmp' (DELIMITER('|'));

alter table original_names add column id serial primary key;

CREATE TABLE names(
   id  serial  primary key  not null,
   taxid              varchar(255) , 
   name        varchar(255) ,                 
   unique_name         varchar(255) , 
   typs    varchar(255)
);

insert into names select id,taxid,name,unique_name,type from original_names;





//after load names.dmp and nodes.dmp to DB
//now there are related tables original_names and original_nodes

create table nodes as select * from original_names where unique_name <> ''  
   or type='scientific name' or type='genbank common name' 
   or type='common name' or type='synonym' or type='equivalent name';

update nodes set name=unique_name where unique_name <> '';

update nodes set type='unique name' where unique_name <> '';

alter table nodes drop column unique_name;

alter table nodes add column rank varchar(255);

update nodes set rank=original_nodes.rank from original_nodes where original_nodes.taxid=nodes.taxid;

create index nodes_pkey on nodes (id);

create index idx_name on nodes (name);




//export from one database 
\copy links to '/Users/air/Desktop/temp.csv';


//then import to another database use tab delimiter
CREATE TABLE nodes(
   id  serial  primary key  not null,
   name              varchar(255) , 
   type        varchar(255) ,                 
   taxid        varchar(255) , 
   rank    varchar(255)
);

\copy nodes from '/Users/air/Desktop/nodes.csv' with DELIMITER '\t';


create table links(
 pvalue             double,
 bio_entity_1       character varying(255), 
 entity_1_name      character varying(255),
 bio_entity_2       character varying(255),
 entity_2_name      character varying(255), 
 weight             double,
 entity_1_type      character varying(255),
 entity_2_type      character varying(255),
 contextid          character varying(255), 
 interaction_type   character varying(255),
 habitat_1          character varying(255), 
 habitat_2          character varying(255),
 id                 integer
 )

\copy links from '/Users/air/Desktop/links.csv' with DELIMITER '\t';
